(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){let primaryColor="#204669",secondaryColor="#a6b5c3",tertiaryColor="#e9edf0";let pieChartColorRange=[primaryColor,secondaryColor,tertiaryColor];let communityFeedbackData;let organisationsArr=[];let emergenciesFilterArr=["All selected"],feedbackTypesArr=["All selected"];let genderPieChart,popGroupsBarChart;let emergencyPiechart,feedbackPieChart,channelPieChart;let topicBarChart,categoryBarChart;let barChartHeight=200;let pieChartHeight=200;let topNumberOfBarChartElement=5;function generateKeyFigures(){var numFeedback=communityFeedbackData.length-1,numOrgs=0;numOrgs=10;$(".statFeedback h5").html("");$(".statFeedback h5").html(numFeedback);$(".statOrg #num").html("");$(".statOrg #num").text(numOrgs)}function generateEmergenciesDropdown(){var options="";for(let index=0;index<emergenciesFilterArr.length;index++){const element=emergenciesFilterArr[index];index==0?options+='<option value="all" selected>'+element+"</option>":options+='<option value="'+element+'">'+element+"</option>"}$("#emergencySelect").append(options)}function generateFeedbackTypesDropdown(){var options="";for(let index=0;index<feedbackTypesArr.length;index++){const element=feedbackTypesArr[index];index==0?options+='<option value="all" selected>'+element+"</option>":options+='<option value="'+element+'">'+element+"</option>"}$("#feedbackTypeSelect").append(options)}function generatePieChart(bind,data){var chart=c3.generate({bindto:"#"+bind,size:{height:pieChartHeight},data:{columns:data,type:"pie"},color:{pattern:pieChartColorRange}});return chart}function generateBarChart(bind,data){var chart=c3.generate({bindto:"#"+bind,size:{height:barChartHeight},data:{x:"x",columns:data,type:"bar"},color:{pattern:[primaryColor]},axis:{rotated:true,x:{type:"category",tick:{centered:true,outer:false}},y:{tick:{centered:true,outer:false,fit:true,count:5,format:d3.format("d")}}},legend:{show:false}});return chart}function getDataForChart(chartType,dataColumn,data=communityFeedbackData){var data=d3.nest().key(function(d){return d[configurations[dataColumn]]}).rollup(function(d){return d.length}).entries(data);data.sort(sortNestedData);var xArr=[],yArr=[],colonnes=[];if(chartType=="Pie"){data.forEach(element=>{var arr=[];arr.push(element.key,element.value);colonnes.push(arr)})}else{xArr.push("x");yArr.push("value");if(data.length>topNumberOfBarChartElement){for(let index=0;index<topNumberOfBarChartElement;index++){const element=data[index];xArr.push(element.key);yArr.push(element.value)}}else{data.forEach(element=>{xArr.push(element.key);yArr.push(element.value)})}colonnes.push(xArr);colonnes.push(yArr)}return colonnes}function sortNestedData(a,b){if(a.value>b.value){return-1}if(a.value<b.value){return 1}return 0}function initFeedbackHomePage(){communityFeedbackData.forEach(element=>{emergenciesFilterArr.includes(element[configurations["Emergency"]])?null:emergenciesFilterArr.push(element[configurations["Emergency"]]);feedbackTypesArr.includes(element[configurations["Type"]])?null:feedbackTypesArr.push(element[configurations["Type"]])});generateKeyFigures();generateEmergenciesDropdown();generateFeedbackTypesDropdown();var genderData=getDataForChart("Pie","Gender");genderPieChart=generatePieChart("genderPieChart",genderData);var popData=getDataForChart("Bar","Population");popGroupsBarChart=generateBarChart("popGroupChart",popData);var emergencyData=getDataForChart("Pie","Emergency");emergencyPiechart=generatePieChart("emergencyPieChart",emergencyData);var feedbackData=getDataForChart("Pie","Type");feedbackPieChart=generatePieChart("feedbackPieChart",feedbackData);var channelData=getDataForChart("Pie","Channel");channelPieChart=generatePieChart("channelPieChart",channelData);var categoryData=getDataForChart("Bar","Category");console.log(categoryData);categoryBarChart=generateBarChart("categoryBarChart",categoryData);topicBarChart=generateBarChart("topicBarChart",categoryData);$("#home").removeClass("hidden")}var feedbackNavs=document.getElementsByClassName("feedbackNav");for(var i=0;i<feedbackNavs.length;i++){feedbackNavs[i].addEventListener("click",updateFeedbackFromNavs)}function updateFeedbackFromNavs(){$(".navigation").removeClass("active");$(".navigation").addClass("hidden");var nav=this.value;$("#"+nav).removeClass("hidden");$(this).toggleClass("active")}$(".navFeedback").on("click",function(){$(".navFeedback").removeClass("active");$(".navigation").addClass("hidden");$(this).addClass("active");var nav=$("a",this).attr("value");$("#"+nav).removeClass("hidden")});$(".navSite").on("click",function(){$(".navSite").removeClass("active");$(".navPage").addClass("hidden");console.log("Changing page");$(this).addClass("active");var nav=$("a",this).attr("value");$("#"+nav+"-page").removeClass("hidden")});let geodataUrl="data/wld.json";let dataURL="data/data.csv";let configFile="data/configuration.csv";let geomData;let configurations;$(document).ready(function(){function getData(){Promise.all([d3.json(geodataUrl),d3.csv(configFile),d3.csv(dataURL)]).then(function(data){geomData=topojson.feature(data[0],data[0].objects.worldtopo12022020);configurations=data[1][0];communityFeedbackData=data[2];initFeedbackHomePage();$(".loader").hide();$("#main").css("opacity",1)})}getData()})},{}]},{},[1]);
